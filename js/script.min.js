const version="0.1.3";var color,playerNameObject,CSS_COLOR_NAMES=["Aqua","Aquamarine","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","BurlyWood","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Crimson","Cyan","DarkBlue","DarkCyan","DarkGoldenRod","DarkGray","DarkGrey","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","Darkorange","DarkOrchid","DarkRed","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkSlateGrey","DarkTurquoise","DarkViolet","DeepPink","DeepSkyBlue","DimGray","DimGrey","DodgerBlue","FireBrick","ForestGreen","Fuchsia","Gainsboro","Gold","GoldenRod","Gray","Grey","Green","GreenYellow","HoneyDew","HotPink","IndianRed","Indigo","Ivory","Khaki","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenRodYellow","LightGray","LightGrey","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSlateGrey","LightSteelBlue","LightYellow","Lime","LimeGreen","Linen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","Navy","OldLace","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleGoldenRod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","Pink","Plum","PowderBlue","Purple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SandyBrown","SeaGreen","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","SlateGrey","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","Yellow","YellowGreen"],resetCounter=0,lampAwsome='<i class="fa fa-lightbulb-o fa-3x" aria-hidden="true"></i>',spinner='<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>',soundOn='<i class="fa fa-volume-up fa-3x" aria-hidden="true" ></i>',soundOff='<i class="fa fa-volume-off fa-3x" aria-hidden="true"></i>',firstInit=0,playerName=null,score=0,bestScore=0,firstMove=!0,initFlag=!1,totalMove=0,overallMove=0,restartFlag=0,overallReset=0,hintCounter=0,totalHintCounter=0,noMoveCounter=0,randomInit=1,musicTemp=[],completeGame=0,hr=(new Date).getHours(),musicList=["files/bensound-anewbeginning.mp3","files/bensound-happiness.mp3","files/bensound-tenderness.mp3","files/bensound-cute.mp3","files/bensound-buddy.mp3"],musicRandom=Math.floor(Math.random()*musicList.length),audio=new Audio(musicList[musicRandom]),playStatus=!1,newRecordNotif="",focusFlag=!1,smartBannerFlag=0,time=180;function audio_control(){1==playStatus?(audio.pause(),playStatus=!1,document.getElementById("sound_on_off").innerHTML=soundOff):(audio.play(),playStatus=!0,document.getElementById("sound_on_off").innerHTML=soundOn)}function local_save(e,t,o,n,r){"undefined"!=typeof Storage&&(localStorage.setItem("score",e),localStorage.setItem("move",t),localStorage.setItem("reset",o),localStorage.setItem("complete",n),localStorage.setItem("hint",r))}function local_load(){"undefined"!=typeof Storage&&((completeGame=parseInt(localStorage.getItem("complete")))?(NaN==(bestScore=parseInt(localStorage.getItem("score")))&&(bestScore=0),overallMove=parseInt(localStorage.getItem("move")),isNaN(overallMove)&&(overallMove=0),overallReset=parseInt(localStorage.getItem("reset")),isNaN(overallReset)&&(overallReset=0),totalHintCounter=parseInt(localStorage.getItem("hint")),isNaN(totalHintCounter)&&(totalHintCounter=0),document.getElementById("score_button").innerHTML="SCORE("+bestScore.toString()+")",document.getElementById("score_button").style.display="inline"):completeGame=0,smartBannerFlag=parseInt(localStorage.getItem("smartflag")),isNaN(smartBannerFlag)&&(smartBannerFlag=0))}function redirect(e){switch(e){case 1:window.open("https://github.com/sepandhaghighi/lightsout");break;case 2:swal({title:"Bitocin Wallet",text:"1XGr9qbZjBpUQJJSB6WtgBQbDTgrhPLPA",customClass:"swal-bitcoin"});break;case 3:window.open("mailto:info@lightsout.ir");break;case 4:window.open("https://www.payping.ir/sepandhaghighi");break;case 5:window.open("help.html","_self");break;case 6:window.open("donate.html","_self");break;case 7:window.open("index.html","_self");break;case 8:hintCounter+=1,totalHintCounter+=1,document.getElementById("Hint").innerHTML="Hint ("+hintCounter+")",swal({title:"Hint",text:'<table align="center" style="font-size:26px"><tr style="font-size:31px"><th >Bottom</th><th >Top</th></tr><tr><td>O---O</td><td>OO---</td></tr><tr><td>-O-O-</td><td>O--O-</td></tr><tr><td>OOO--</td><td>-O---</td></tr><tr><td>--OOO</td><td>---O-</td></tr><tr><td>O-OO-</td><td>----O</td></tr><tr><td>-OO-O</td><td>O----</td></tr><tr><td>OO-OO</td><td>--O--</td> </tr></table>',html:!0});break;case 9:completeGame>0&&swal({title:"Score!",text:'<table align="center" style="font-size:26px"><tr><td>Best Score</td><td>'+bestScore.toString()+"</td></tr><tr><td>Game</td><td>"+completeGame.toString()+"</td></tr><tr><td>Total Move</td><td>"+overallMove.toString()+"</td></tr><tr><td>Total Reset</td><td>"+overallReset.toString()+"</td></tr><tr><td>Total Hint</td><td>"+totalHintCounter.toString()+"</td></tr></table>",html:!0,customClass:"swal-score"});break;default:window.open("https://github.com/sepandhaghighi/lightsout")}}function swal_help(){swal({title:"Hi",text:'<p style="text-align:justify">The game consists of a 5 by 5 grid of lights. When the game starts, a random number or a stored pattern of these lights is switched on. Pressing any of the lights will toggle it and the four adjacent lights. The goal of the puzzle is to switch all the lights off, preferably in as few button presses as possible. After first touch you have 3 minutes to win as many as possible ;-)</p>',html:!0,customClass:"swal-wide"})}function getname(){local_load(),swal_help(),init(1)}function init(e){var t,o,n,r,a,l;firstInit=1,linear_gradient=Math.round(Math.random()),color=CSS_COLOR_NAMES[Math.floor(Math.random()*CSS_COLOR_NAMES.length)].toLowerCase();var i=[];for(n=0,(a=document.getElementById("game_name")).style.color=color,a.innerHTML="Lights Out Game (v"+version+")",r=document.getElementById("move"),l=document.getElementById("reset"),initFlag=!0,2==e&&(resetCounter+=1,overallReset+=1,overallMove-=parseInt(r.innerHTML),totalMove-=parseInt(r.innerHTML),l.innerHTML="Reset ("+resetCounter+")");n<randomInit;)o=Math.floor(25*Math.random()+1),i.indexOf(o)<0&&(i.push(o),n+=1);for(t=1;t<26;t++)document.getElementById(t.toString()).style.backgroundColor=color,document.getElementById(t.toString()).innerHTML="";for(t=0;t<i.length;t++)reply_click(i[t].toString());r.innerHTML=0,initFlag=!1}function reply_click(e){var t,o;o=document.getElementById("move"),(1==firstMove&&0==initFlag||1==focusFlag)&&(display=document.querySelector("#time"),startTimer(time,display),firstMove=!1,focusFlag=!1),t=parseInt(e),1==firstInit&&(t+5<=25&&toggle(t+5),t-5>=1&&toggle(t-5),(t-1)%5==0?toggle(t+1):t%5==0?toggle(t-1):(toggle(t-1),toggle(t+1)),0==initFlag&&(o.innerHTML=parseInt(o.innerHTML)+1,totalMove+=1,overallMove+=1),toggle(t),end_game()),noMoveCounter=0}function toggle(e){var t;"white"!=(t=document.getElementById(e.toString())).style.backgroundColor?(t.style.backgroundColor="white",t.innerHTML=lampAwsome):(t.style.backgroundColor=color,t.innerHTML="")}function end_game(){var e,t,o;for(t=0,e=1;e<26;e++)if(""!=document.getElementById(e.toString()).innerHTML){t+=1;break}0==t&&(score+=1,(o=document.getElementById("win")).innerHTML=parseInt(o.innerHTML)+1,randomInit=Math.min(randomInit+1,15),init(1))}function restart_game(){0==resetCounter&&1==firstMove&&0==hintCounter?swal("Restart???!!!"):swal({title:"Are you sure?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",cancelButtonText:"No",closeOnConfirm:!0,closeOnCancel:!0},function(e){e&&(0==firstMove?1==focusFlag?(focusFlag=!1,overallMove-=totalMove,overallReset-=resetCounter,totalHintCounter-=hintCounter,time=180,restart_config(document.querySelector("#time"))):restartFlag=1:(reset=document.getElementById("reset"),reset.innerHTML="Reset!",document.getElementById("Hint").innerHTML="Hint",overallReset-=resetCounter,totalHintCounter-=hintCounter,resetCounter=0,hintCounter=0))})}function startTimer(e,t){var o,n,r=e,a=setInterval(function(){o=parseInt(r/60,10),n=parseInt(r%60,10),document.hasFocus()||(focusFlag=!0,clearInterval(a),time=r),o=o<10?"0"+o:o,n=n<10?"0"+n:n,t.textContent=o+":"+n,noMoveCounter+=1,90==r?t.style.color="orange":60==r&&(t.style.color="red"),noMoveCounter>=60&&r>100&&(swal({title:"Hurry Up!!!",imageUrl:"images/hurry.png"}),noMoveCounter=0),(--r<0||1==restartFlag)&&(0==restartFlag?(bestScore<score?(bestScore=score,newRecordNotif="<h2>New Record!</h2>&nbsp;"):newRecordNotif="",completeGame+=1,document.getElementById("score_button").innerHTML="SCORE("+bestScore.toString()+")",local_save(bestScore,overallMove,overallReset,completeGame,totalHintCounter),1==completeGame&&(document.getElementById("score_button").style.display="inline"),swal({title:"Time's Up",text:newRecordNotif+'<table align="center" style="font-size:26px"><tr><td>Score</td><td>'+score.toString()+"</td></tr><tr><td>Reset</td><td>"+resetCounter.toString()+"</td></tr><tr><td>Move</td><td>"+totalMove.toString()+"</td></tr><tr><td>Hint</td><td>"+hintCounter.toString()+"</td></tr></table>",html:!0,customClass:"swal-score",imageUrl:"images/timeup.png"})):(overallMove-=totalMove,overallReset-=resetCounter,totalHintCounter-=hintCounter),r=e,time=180,restart_config(t),clearInterval(a))},1e3)}function restart_config(e){e.textContent="TI:ME",totalMove=0,randomInit=1,e.style.color="black",win=document.getElementById("win"),win.innerHTML=0,score=0,reset=document.getElementById("reset"),reset.innerHTML="Reset!",document.getElementById("Hint").innerHTML="Hint",hintCounter=0,resetCounter=0,firstMove=!0,restartFlag=0,init(1)}function getMobileOperatingSystem(){var e=navigator.userAgent||navigator.vendor||window.opera;/windows phone/i.test(e),/android/i.test(e)&&smartBannerFlag<3&&(document.getElementById("smartabanner").style.display="block"),/iPad|iPhone|iPod/.test(e)&&window.MSStream}function close_banner(){document.getElementById("smartabanner").style.display="none",smartBannerFlag+=1,localStorage.setItem("smartflag",smartBannerFlag)}function apkdownload(){smartBannerFlag=3,localStorage.setItem("smartflag",smartBannerFlag)}audio.onended=function(){musicTemp.push(musicList.splice(musicRandom,1)),musicRandom=Math.floor(Math.random()*musicList.length),audio.src=musicList[musicRandom],audio.load(),1==musicList.length&&(musicList.push.apply(musicList,musicTemp),musicTemp=[]),audio.play()},(hr>=19||hr<6)&&(lampAwsome='<i class="fa fa-lightbulb-o fa-3x" aria-hidden="true" style="color:gold"></i>'),shortcut.add("h",function(){redirect(8)}),shortcut.add("r",function(){init(2)}),shortcut.add("q",function(){swal_help()}),shortcut.add("Ctrl",function(){restart_game()});